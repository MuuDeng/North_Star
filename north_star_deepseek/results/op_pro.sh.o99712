 Data for JOB [38889,1] offset 0 Total slots allocated 4

 ========================   JOB MAP   ========================

 Data for node: a2ap-dgx008	Num slots: 2	Max slots: 0	Num procs: 1
 	Process OMPI jobid: [38889,1] App: 0 Process rank: 0 Bound: UNBOUND

 Data for node: a2ap-dgx024	Num slots: 2	Max slots: 0	Num procs: 1
 	Process OMPI jobid: [38889,1] App: 0 Process rank: 1 Bound: N/A

 =============================================================
 Data for JOB [38889,1] offset 0 Total slots allocated 4

 ========================   JOB MAP   ========================

 Data for node: a2ap-dgx008	Num slots: 2	Max slots: 0	Num procs: 1
 	Process OMPI jobid: [38889,1] App: 0 Process rank: 0 Bound: N/A

 Data for node: a2ap-dgx024	Num slots: 2	Max slots: 0	Num procs: 1
 	Process OMPI jobid: [38889,1] App: 0 Process rank: 1 Bound: UNBOUND

 =============================================================
[1,0]<stderr>:[a2ap-dgx008:1594037] MCW rank 0 is not bound (or bound to all available processors)
[1,1]<stderr>:[a2ap-dgx024:1094851] MCW rank 1 is not bound (or bound to all available processors)
[1,0]<stderr>:[DBG] host=a2ap-dgx008 rank=0 local=0 node=0 world=2
[1,1]<stderr>:[DBG] host=a2ap-dgx024 rank=1 local=0 node=1 world=2
[1,0]<stderr>:usage: bench_offline_throughput.py [-h] --model-path MODEL_PATH
[1,0]<stderr>:                                   [--tokenizer-path TOKENIZER_PATH]
[1,0]<stderr>:                                   [--tokenizer-mode {auto,slow}]
[1,0]<stderr>:                                   [--skip-tokenizer-init]
[1,0]<stderr>:                                   [--load-format {auto,pt,safetensors,npcache,dummy,sharded_state,gguf,bitsandbytes,layered,remote}]
[1,0]<stderr>:                                   [--model-loader-extra-config MODEL_LOADER_EXTRA_CONFIG]
[1,0]<stderr>:                                   [--trust-remote-code]
[1,0]<stderr>:                                   [--context-length CONTEXT_LENGTH]
[1,0]<stderr>:                                   [--is-embedding] [--enable-multimodal]
[1,0]<stderr>:                                   [--revision REVISION]
[1,0]<stderr>:                                   [--model-impl MODEL_IMPL] [--host HOST]
[1,0]<stderr>:                                   [--port PORT] [--skip-server-warmup]
[1,0]<stderr>:                                   [--warmups WARMUPS] [--nccl-port NCCL_PORT]
[1,0]<stderr>:                                   [--dtype {auto,half,float16,bfloat16,float,float32}]
[1,0]<stderr>:                                   [--quantization {awq,fp8,gptq,marlin,gptq_marlin,awq_marlin,bitsandbytes,gguf,modelopt,modelopt_fp4,petit_nvfp4,w8a8_int8,w8a8_fp8,moe_wna16,qoq,w4afp8,mxfp4}]
[1,0]<stderr>:                                   [--quantization-param-path QUANTIZATION_PARAM_PATH]
[1,0]<stderr>:                                   [--kv-cache-dtype {auto,fp8_e5m2,fp8_e4m3}]
[1,0]<stderr>:                                   [--mem-fraction-static MEM_FRACTION_STATIC]
[1,0]<stderr>:                                   [--max-running-requests MAX_RUNNING_REQUESTS]
[1,0]<stderr>:                                   [--max-queued-requests MAX_QUEUED_REQUESTS]
[1,0]<stderr>:                                   [--max-total-tokens MAX_TOTAL_TOKENS]
[1,0]<stderr>:                                   [--chunked-prefill-size CHUNKED_PREFILL_SIZE]
[1,0]<stderr>:                                   [--max-prefill-tokens MAX_PREFILL_TOKENS]
[1,0]<stderr>:                                   [--schedule-policy {lpm,random,fcfs,dfs-weight,lof}]
[1,0]<stderr>:                                   [--schedule-conservativeness SCHEDULE_CONSERVATIVENESS]
[1,0]<stderr>:                                   [--cpu-offload-gb CPU_OFFLOAD_GB]
[1,0]<stderr>:                                   [--page-size PAGE_SIZE]
[1,0]<stderr>:                                   [--hybrid-kvcache-ratio [HYBRID_KVCACHE_RATIO]]
[1,0]<stderr>:                                   [--swa-full-tokens-ratio SWA_FULL_TOKENS_RATIO]
[1,0]<stderr>:                                   [--disable-hybrid-swa-memory]
[1,0]<stderr>:                                   [--device DEVICE]
[1,0]<stderr>:                                   [--tensor-parallel-size TENSOR_PARALLEL_SIZE]
[1,0]<stderr>:                                   [--pipeline-parallel-size PIPELINE_PARALLEL_SIZE]
[1,0]<stderr>:                                   [--max-micro-batch-size MAX_MICRO_BATCH_SIZE]
[1,0]<stderr>:                                   [--stream-interval STREAM_INTERVAL]
[1,0]<stderr>:                                   [--stream-output]
[1,0]<stderr>:                                   [--random-seed RANDOM_SEED]
[1,0]<stderr>:                                   [--constrained-json-whitespace-pattern CONSTRAINED_JSON_WHITESPACE_PATTERN]
[1,0]<stderr>:                                   [--watchdog-timeout WATCHDOG_TIMEOUT]
[1,0]<stderr>:                                   [--dist-timeout DIST_TIMEOUT]
[1,0]<stderr>:                                   [--download-dir DOWNLOAD_DIR]
[1,0]<stderr>:                                   [--base-gpu-id BASE_GPU_ID]
[1,0]<stderr>:                                   [--gpu-id-step GPU_ID_STEP]
[1,0]<stderr>:                                   [--sleep-on-idle] [--log-level LOG_LEVEL]
[1,0]<stderr>:                                   [--log-level-http LOG_LEVEL_HTTP]
[1,0]<stderr>:                                   [--log-requests]
[1,0]<stderr>:                                   [--log-requests-level {0,1,2,3}]
[1,0]<stderr>:                                   [--crash-dump-folder CRASH_DUMP_FOLDER]
[1,0]<stderr>:                                   [--show-time-cost] [--enable-metrics]
[1,0]<stderr>:                                   [--enable-metrics-for-all-schedulers]
[1,0]<stderr>:                                   [--bucket-time-to-first-token BUCKET_TIME_TO_FIRST_TOKEN [BUCKET_TIME_TO_FIRST_TOKEN ...]]
[1,0]<stderr>:                                   [--bucket-inter-token-latency BUCKET_INTER_TOKEN_LATENCY [BUCKET_INTER_TOKEN_LATENCY ...]]
[1,0]<stderr>:       [1,0]<stderr>:                            [--bucket-e2e-request-latency BUCKET_E2E_REQUEST_LATENCY [BUCKET_E2E_REQUEST_LATENCY ...]]
[1,0]<stderr>:                                   [--collect-tokens-histogram]
[1,0]<stderr>:                                   [--decode-log-interval DECODE_LOG_INTERVAL]
[1,0]<stderr>:                                   [--enable-request-time-stats-logging]
[1,0]<stderr>:                                   [--kv-events-config KV_EVENTS_CONFIG]
[1,0]<stderr>:                                   [--api-key API_KEY]
[1,0]<stderr>:                                   [--served-model-name SERVED_MODEL_NAME]
[1,0]<stderr>:                                   [--weight-version WEIGHT_VERSION]
[1,0]<stderr>:                                   [--chat-template CHAT_TEMPLATE]
[1,0]<stderr>:                                   [--completion-template COMPLETION_TEMPLATE]
[1,0]<stderr>:                                   [--file-storage-path FILE_STORAGE_PATH]
[1,0]<stderr>:                                   [--enable-cache-report]
[1,0]<stderr>:                                   [--reasoning-parser {deepseek-r1,qwen3,qwen3-thinking,glm45,kimi,step3,gpt-oss}]
[1,0]<stderr>:                                   [--tool-call-parser {qwen25,mistral,llama3,deepseekv3,pythonic,kimi_k2,qwen3_coder,glm45,step3,gpt-oss}]
[1,0]<stderr>:                                   [--tool-server TOOL_SERVER]
[1,0]<stderr>:                                   [--data-parallel-size DATA_PARALLEL_SIZE]
[1,0]<stderr>:                                   [--load-balance-method {round_robin,shortest_queue,minimum_tokens}]
[1,0]<stderr>:                                   [--dist-init-addr DIST_INIT_ADDR]
[1,0]<stderr>:                                   [--nnodes NNODES] [--node-rank NODE_RANK]
[1,0]<stderr>:                                   [--json-model-override-args JSON_MODEL_OVERRIDE_ARGS]
[1,0]<stderr>:                                   [--preferred-sampling-params PREFERRED_SAMPLING_PARAMS]
[1,0]<stderr>:                                   [--enable-lora]
[1,0]<stderr>:                                   [--max-lora-rank MAX_LORA_RANK]
[1,0]<stderr>:                                   [--lora-target-modules [{q_proj,k_proj,v_proj,o_proj,gate_proj,up_proj,down_proj,all} ...]]
[1,0]<stderr>:                                   [--lora-paths [LORA_PATHS ...]]
[1,0]<stderr>:                                   [--max-loras-per-batch MAX_LORAS_PER_BATCH]
[1,0]<stderr>:                                   [--max-loaded-loras MAX_LOADED_LORAS]
[1,0]<stderr>:                                   [--lora-backend LORA_BACKEND]
[1,0]<stderr>:                                   [--attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,0]<stderr>:                                   [--prefill-attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,0]<stderr>:                                   [--decode-attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,0]<stderr>:                                   [--sampling-backend {flashinfer,pytorch}]
[1,0]<stderr>:                                   [--grammar-backend {xgrammar,outlines,llguidance,none}]
[1,0]<stderr>:                                   [--mm-attention-backend {sdpa,fa3,triton_attn}]
[1,0]<stderr>:                                   [--speculative-algorithm {EAGLE,EAGLE3,NEXTN}]
[1,0]<stderr>:                                   [--speculative-draft-model-path SPECULATIVE_DRAFT_MODEL_PATH]
[1,0]<stderr>:                                   [--speculative-num-steps SPECULATIVE_NUM_STEPS]
[1,0]<stderr>:                                   [--speculative-eagle-topk SPECULATIVE_EAGLE_TOPK]
[1,0]<stderr>:                                   [--speculative-num-draft-tokens SPECULATIVE_NUM_DRAFT_TOKENS]
[1,0]<stderr>:                                   [--speculative-accept-threshold-single SPECULATIVE_ACCEPT_THRESHOLD_SINGLE]
[1,0]<stderr>:                                   [--speculative-accept-threshold-acc SPECULATIVE_ACCEPT_THRESHOLD_ACC]
[1,0]<stderr>:                                   [--speculative-token-map SPECULATIVE_TOKEN_MAP]
[1,0]<stderr>:                                   [--expert-parallel-size EXPERT_PARALLEL_SIZE]
[1,0]<stderr>:                                   [--moe-a2a-backend {deepep}]
[1,0]<stderr>:                                   [--enable-flashinfer-cutlass-moe]
[1,0]<stderr>:                                   [--enable-flashinfer-trtllm-moe]
[1,0]<stderr>:   [1,0]<stderr>:                                [--enable-flashinfer-allreduce-fusion]
[1,0]<stderr>:                                   [--deepep-mode {normal,low_latency,auto}]
[1,0]<stderr>:                                   [--ep-num-redundant-experts EP_NUM_REDUNDANT_EXPERTS]
[1,0]<stderr>:                                   [--ep-dispatch-algorithm EP_DISPATCH_ALGORITHM]
[1,0]<stderr>:                                   [--init-expert-location INIT_EXPERT_LOCATION]
[1,0]<stderr>:                                   [--enable-eplb]
[1,0]<stderr>:                                   [--eplb-algorithm EPLB_ALGORITHM]
[1,0]<stderr>:                                   [--eplb-rebalance-num-iterations EPLB_REBALANCE_NUM_ITERATIONS]
[1,0]<stderr>:                                   [--eplb-rebalance-layers-per-chunk EPLB_REBALANCE_LAYERS_PER_CHUNK]
[1,0]<stderr>:                                   [--expert-distribution-recorder-mode EXPERT_DISTRIBUTION_RECORDER_MODE]
[1,0]<stderr>:                                   [--expert-distribution-recorder-buffer-size EXPERT_DISTRIBUTION_RECORDER_BUFFER_SIZE]
[1,0]<stderr>:                                   [--enable-expert-distribution-metrics]
[1,0]<stderr>:                                   [--deepep-config DEEPEP_CONFIG]
[1,0]<stderr>:                                   [--moe-dense-tp-size MOE_DENSE_TP_SIZE]
[1,0]<stderr>:                                   [--enable-hierarchical-cache]
[1,0]<stderr>:                                   [--hicache-ratio HICACHE_RATIO]
[1,0]<stderr>:                                   [--hicache-size HICACHE_SIZE]
[1,0]<stderr>:                                   [--hicache-write-policy {write_back,write_through,write_through_selective}]
[1,0]<stderr>:                                   [--hicache-io-backend {direct,kernel}]
[1,0]<stderr>:                                   [--hicache-mem-layout {layer_first,page_first}]
[1,0]<stderr>:                                   [--hicache-storage-backend {file,mooncake,hf3fs,nixl}]
[1,0]<stderr>:                                   [--hicache-storage-prefetch-policy {best_effort,wait_complete,timeout}]
[1,0]<stderr>:                                   [--enable-double-sparsity]
[1,0]<stderr>:                                   [--ds-channel-config-path DS_CHANNEL_CONFIG_PATH]
[1,0]<stderr>:                                   [--ds-heavy-channel-num DS_HEAVY_CHANNEL_NUM]
[1,0]<stderr>:                                   [--ds-heavy-token-num DS_HEAVY_TOKEN_NUM]
[1,0]<stderr>:                                   [--ds-heavy-channel-type DS_HEAVY_CHANNEL_TYPE]
[1,0]<stderr>:                                   [--ds-sparse-decode-threshold DS_SPARSE_DECODE_THRESHOLD]
[1,0]<stderr>:                                   [--disable-radix-cache]
[1,0]<stderr>:                                   [--cuda-graph-max-bs CUDA_GRAPH_MAX_BS]
[1,0]<stderr>:                                   [--cuda-graph-bs CUDA_GRAPH_BS [CUDA_GRAPH_BS ...]]
[1,0]<stderr>:                                   [--disable-cuda-graph]
[1,0]<stderr>:                                   [--disable-cuda-graph-padding]
[1,0]<stderr>:                                   [--enable-profile-cuda-graph]
[1,0]<stderr>:                                   [--enable-cudagraph-gc]
[1,0]<stderr>:                                   [--enable-nccl-nvls] [--enable-symm-mem]
[1,0]<stderr>:                                   [--enable-tokenizer-batch-encode]
[1,0]<stderr>:                                   [--disable-outlines-disk-cache]
[1,0]<stderr>:                                   [--disable-custom-all-reduce]
[1,0]<stderr>:                                   [--enable-mscclpp]
[1,0]<stderr>:                                   [--disable-overlap-schedule]
[1,0]<stderr>:                                   [--enable-mixed-chunk]
[1,0]<stderr>:                                   [--enable-dp-attention]
[1,0]<stderr>:                                   [--enable-dp-lm-head]
[1,0]<stderr>:                                   [--enable-two-batch-overlap]
[1,0]<stderr>:                                   [--tbo-token-distribution-threshold TBO_TOKEN_DISTRIBUTION_THRESHOLD]
[1,0]<stderr>:                                   [--enable-torch-compile]
[1,0]<stderr>:                                   [--torch-compile-max-bs TORCH_COMPILE_MAX_BS]
[1,0]<stderr>:                                   [--torchao-config TORCHAO_CONFIG]
[1,0]<stderr>:                                   [--enable-nan-detection]
[1,0]<stderr>:                                   [--enable-p2p-check]
[1,0]<stderr>:                                   [--triton-attention-reduce-in-fp32]
[1,0]<stderr>:                                   [--triton-attention-num-kv-splits TRITON_ATTENTION_NUM_KV_SPLITS]
[1,0]<stderr>:                                   [--num-continuous-decode-steps NUM_CONTINUOUS_[1,0]<stderr>:DECODE_STEPS]
[1,0]<stderr>:                                   [--delete-ckpt-after-loading]
[1,0]<stderr>:                                   [--enable-memory-saver]
[1,0]<stderr>:                                   [--allow-auto-truncate]
[1,0]<stderr>:                                   [--enable-custom-logit-processor]
[1,0]<stderr>:                                   [--flashinfer-mla-disable-ragged]
[1,0]<stderr>:                                   [--disable-shared-experts-fusion]
[1,0]<stderr>:                                   [--disable-chunked-prefix-cache]
[1,0]<stderr>:                                   [--disable-fast-image-processor]
[1,0]<stderr>:                                   [--enable-return-hidden-states]
[1,0]<stderr>:                                   [--enable-triton-kernel-moe]
[1,0]<stderr>:                                   [--enable-flashinfer-mxfp4-moe]
[1,0]<stderr>:                                   [--scheduler-recv-interval SCHEDULER_RECV_INTERVAL]
[1,0]<stderr>:                                   [--debug-tensor-dump-output-folder DEBUG_TENSOR_DUMP_OUTPUT_FOLDER]
[1,0]<stderr>:                                   [--debug-tensor-dump-input-file DEBUG_TENSOR_DUMP_INPUT_FILE]
[1,0]<stderr>:                                   [--debug-tensor-dump-inject DEBUG_TENSOR_DUMP_INJECT]
[1,0]<stderr>:                                   [--debug-tensor-dump-prefill-only]
[1,0]<stderr>:                                   [--disaggregation-mode {null,prefill,decode}]
[1,0]<stderr>:                                   [--disaggregation-transfer-backend {mooncake,nixl,ascend}]
[1,0]<stderr>:                                   [--disaggregation-bootstrap-port DISAGGREGATION_BOOTSTRAP_PORT]
[1,0]<stderr>:                                   [--disaggregation-decode-tp DISAGGREGATION_DECODE_TP]
[1,0]<stderr>:                                   [--disaggregation-decode-dp DISAGGREGATION_DECODE_DP]
[1,0]<stderr>:                                   [--disaggregation-prefill-pp DISAGGREGATION_PREFILL_PP]
[1,0]<stderr>:                                   [--disaggregation-ib-device DISAGGREGATION_IB_DEVICE]
[1,0]<stderr>:                                   [--num-reserved-decode-tokens NUM_RESERVED_DECODE_TOKENS]
[1,0]<stderr>:                                   [--pdlb-url PDLB_URL]
[1,0]<stderr>:                                   [--custom-weight-loader [CUSTOM_WEIGHT_LOADER ...]]
[1,0]<stderr>:                                   [--enable-pdmux]
[1,0]<stderr>:                                   [--sm-group-num SM_GROUP_NUM]
[1,0]<stderr>:                                   [--weight-loader-disable-mmap]
[1,0]<stderr>:                                   [--enable-ep-moe] [--enable-deepep-moe]
[1,0]<stderr>:                                   [--backend BACKEND]
[1,0]<stderr>:                                   [--result-filename RESULT_FILENAME]
[1,0]<stderr>:                                   [--dataset-name {sharegpt,random,generated-shared-prefix}]
[1,0]<stderr>:                                   [--dataset-path DATASET_PATH]
[1,0]<stderr>:                                   [--num-prompts NUM_PROMPTS]
[1,0]<stderr>:                                   [--sharegpt-output-len SHAREGPT_OUTPUT_LEN]
[1,0]<stderr>:                                   [--sharegpt-context-len SHAREGPT_CONTEXT_LEN]
[1,0]<stderr>:                                   [--random-input-len RANDOM_INPUT_LEN]
[1,0]<stderr>:                                   [--random-output-len RANDOM_OUTPUT_LEN]
[1,0]<stderr>:                                   [--random-range-ratio RANDOM_RANGE_RATIO]
[1,0]<stderr>:                                   [--gsp-num-groups GSP_NUM_GROUPS]
[1,0]<stderr>:                                   [--gsp-prompts-per-group GSP_PROMPTS_PER_GROUP]
[1,0]<stderr>:                                   [--gsp-system-prompt-len GSP_SYSTEM_PROMPT_LEN]
[1,0]<stderr>:                                   [--gsp-question-len GSP_QUESTION_LEN]
[1,0]<stderr>:                                   [--gsp-output-len GSP_OUTPUT_LEN]
[1,0]<stderr>:                                   [--seed SEED] [--disable-ignore-eos]
[1,0]<stderr>:                                   [--extra-request-body {"key1": "value1", "key2": "value2"}]
[1,0]<stderr>:                                   [--apply-chat-template] [--profile]
[1,0]<stderr>:                                   [--skip-warmup] [--do-not-exit]
[1,0]<stderr>:                                   [--prompt-suffix PROMPT_SUFFIX]
[1,0]<stderr>:bench_offline_throughput.py: error: unrecognized arguments: --enable-paged-attn --overlap-comm --max-concurrency 32 --max-batch-size 32
[1,1]<stderr>:usage: bench_offline_throughput.py [-h] --model-path MODEL_PATH
[1,1]<stderr>:                                   [--tokenizer-path TOKENIZER_PATH]
[1,1]<stderr>:                                   [--tokenizer-mode {auto,slow}]
[1,1]<stderr>:                                   [--skip-tokenizer-init]
[1,1]<stderr>:                                   [--load-format {auto,pt,safetensors,npcache,dummy,sharded_state,gguf,bitsandbytes,layered,remote}]
[1,1]<stderr>:                                   [--model-loader-extra-config MODEL_LOADER_EXTRA_CONFIG]
[1,1]<stderr>:                                   [--trust-remote-code]
[1,1]<stderr>:                                   [--context-length CONTEXT_LENGTH]
[1,1]<stderr>:                                   [--is-embedding] [--enable-multimodal]
[1,1]<stderr>:                                   [--revision REVISION]
[1,1]<stderr>:                                   [--model-impl MODEL_IMPL] [--host HOST]
[1,1]<stderr>:                                   [--port PORT] [--skip-server-warmup]
[1,1]<stderr>:                                   [--warmups WARMUPS] [--nccl-port NCCL_PORT]
[1,1]<stderr>:                                   [--dtype {auto,half,float16,bfloat16,float,float32}]
[1,1]<stderr>:                                   [--quantization {awq,fp8,gptq,marlin,gptq_marlin,awq_marlin,bitsandbytes,gguf,modelopt,modelopt_fp4,petit_nvfp4,w8a8_int8,w8a8_fp8,moe_wna16,qoq,w4afp8,mxfp4}]
[1,1]<stderr>:                                   [--quantization-param-path QUANTIZATION_PARAM_PATH]
[1,1]<stderr>:                                   [--kv-cache-dtype {auto,fp8_e5m2,fp8_e4m3}]
[1,1]<stderr>:                                   [--mem-fraction-static MEM_FRACTION_STATIC]
[1,1]<stderr>:                                   [--max-running-requests MAX_RUNNING_REQUESTS]
[1,1]<stderr>:                                   [--max-queued-requests MAX_QUEUED_REQUESTS]
[1,1]<stderr>:                                   [--max-total-tokens MAX_TOTAL_TOKENS]
[1,1]<stderr>:                                   [--chunked-prefill-size CHUNKED_PREFILL_SIZE]
[1,1]<stderr>:                                   [--max-prefill-tokens MAX_PREFILL_TOKENS]
[1,1]<stderr>:                                   [--schedule-policy {lpm,random,fcfs,dfs-weight,lof}]
[1,1]<stderr>:                                   [--schedule-conservativeness SCHEDULE_CONSERVATIVENESS]
[1,1]<stderr>:                                   [--cpu-offload-gb CPU_OFFLOAD_GB]
[1,1]<stderr>:                                   [--page-size PAGE_SIZE]
[1,1]<stderr>:                                   [--hybrid-kvcache-ratio [HYBRID_KVCACHE_RATIO]]
[1,1]<stderr>:                                   [--swa-full-tokens-ratio SWA_FULL_TOKENS_RATIO]
[1,1]<stderr>:                                   [--disable-hybrid-swa-memory]
[1,1]<stderr>:                                   [--device DEVICE]
[1,1]<stderr>:                                   [--tensor-parallel-size TENSOR_PARALLEL_SIZE]
[1,1]<stderr>:                                   [--pipeline-parallel-size PIPELINE_PARALLEL_SIZE]
[1,1]<stderr>:                                   [--max-micro-batch-size MAX_MICRO_BATCH_SIZE]
[1,1]<stderr>:                                   [--stream-interval STREAM_INTERVAL]
[1,1]<stderr>:                                   [--stream-output]
[1,1]<stderr>:                                   [--random-seed RANDOM_SEED]
[1,1]<stderr>:                                   [--constrained-json-whitespace-pattern CONSTRAINED_JSON_WHITESPACE_PATTERN]
[1,1]<stderr>:                                   [--watchdog-timeout WATCHDOG_TIMEOUT]
[1,1]<stderr>:                                   [--dist-timeout DIST_TIMEOUT]
[1,1]<stderr>:                                   [--download-dir DOWNLOAD_DIR]
[1,1]<stderr>:                                   [--base-gpu-id BASE_GPU_ID]
[1,1]<stderr>:                                   [--gpu-id-step GPU_ID_STEP]
[1,1]<stderr>:                                   [--sleep-on-idle] [--log-level LOG_LEVEL]
[1,1]<stderr>:                                   [--log-level-http LOG_LEVEL_HTTP]
[1,1]<stderr>:                                   [--log-requests]
[1,1]<stderr>:                                   [--log-requests-level {0,1,2,3}]
[1,1]<stderr>:                                   [--crash-dump-folder CRASH_DUMP_FOLDER]
[1,1]<stderr>:                                   [--show-time-cost] [--enable-metrics]
[1,1]<stderr>:                                   [--enable-metrics-for-all-schedulers]
[1,1]<stderr>:                                   [--bucket-time-to-first-token BUCKET_TIME_TO_FIRST_TOKEN [BUCKET_TIME_TO_FIRST_TOKEN ...]]
[1,1]<stderr>:                                   [--bucket-inter-token-latency BUCKET_INTER_TOKEN_LATENCY [BUCKET_INTER_TOKEN_LATENCY ...]]
[1,1]<stderr>:       [1,1]<stderr>:                            [--bucket-e2e-request-latency BUCKET_E2E_REQUEST_LATENCY [BUCKET_E2E_REQUEST_LATENCY ...]]
[1,1]<stderr>:                                   [--collect-tokens-histogram]
[1,1]<stderr>:                                   [--decode-log-interval DECODE_LOG_INTERVAL]
[1,1]<stderr>:                                   [--enable-request-time-stats-logging]
[1,1]<stderr>:                                   [--kv-events-config KV_EVENTS_CONFIG]
[1,1]<stderr>:                                   [--api-key API_KEY]
[1,1]<stderr>:                                   [--served-model-name SERVED_MODEL_NAME]
[1,1]<stderr>:                                   [--weight-version WEIGHT_VERSION]
[1,1]<stderr>:                                   [--chat-template CHAT_TEMPLATE]
[1,1]<stderr>:                                   [--completion-template COMPLETION_TEMPLATE]
[1,1]<stderr>:                                   [--file-storage-path FILE_STORAGE_PATH]
[1,1]<stderr>:                                   [--enable-cache-report]
[1,1]<stderr>:                                   [--reasoning-parser {deepseek-r1,qwen3,qwen3-thinking,glm45,kimi,step3,gpt-oss}]
[1,1]<stderr>:                                   [--tool-call-parser {qwen25,mistral,llama3,deepseekv3,pythonic,kimi_k2,qwen3_coder,glm45,step3,gpt-oss}]
[1,1]<stderr>:                                   [--tool-server TOOL_SERVER]
[1,1]<stderr>:                                   [--data-parallel-size DATA_PARALLEL_SIZE]
[1,1]<stderr>:                                   [--load-balance-method {round_robin,shortest_queue,minimum_tokens}]
[1,1]<stderr>:                                   [--dist-init-addr DIST_INIT_ADDR]
[1,1]<stderr>:                                   [--nnodes NNODES] [--node-rank NODE_RANK]
[1,1]<stderr>:                                   [--json-model-override-args JSON_MODEL_OVERRIDE_ARGS]
[1,1]<stderr>:                                   [--preferred-sampling-params PREFERRED_SAMPLING_PARAMS]
[1,1]<stderr>:                                   [--enable-lora]
[1,1]<stderr>:                                   [--max-lora-rank MAX_LORA_RANK]
[1,1]<stderr>:                                   [--lora-target-modules [{q_proj,k_proj,v_proj,o_proj,gate_proj,up_proj,down_proj,all} ...]]
[1,1]<stderr>:                                   [--lora-paths [LORA_PATHS ...]]
[1,1]<stderr>:                                   [--max-loras-per-batch MAX_LORAS_PER_BATCH]
[1,1]<stderr>:                                   [--max-loaded-loras MAX_LOADED_LORAS]
[1,1]<stderr>:                                   [--lora-backend LORA_BACKEND]
[1,1]<stderr>:                                   [--attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,1]<stderr>:                                   [--prefill-attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,1]<stderr>:                                   [--decode-attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,1]<stderr>:                                   [--sampling-backend {flashinfer,pytorch}]
[1,1]<stderr>:                                   [--grammar-backend {xgrammar,outlines,llguidance,none}]
[1,1]<stderr>:                                   [--mm-attention-backend {sdpa,fa3,triton_attn}]
[1,1]<stderr>:                                   [--speculative-algorithm {EAGLE,EAGLE3,NEXTN}]
[1,1]<stderr>:                                   [--speculative-draft-model-path SPECULATIVE_DRAFT_MODEL_PATH]
[1,1]<stderr>:                                   [--speculative-num-steps SPECULATIVE_NUM_STEPS]
[1,1]<stderr>:                                   [--speculative-eagle-topk SPECULATIVE_EAGLE_TOPK]
[1,1]<stderr>:                                   [--speculative-num-draft-tokens SPECULATIVE_NUM_DRAFT_TOKENS]
[1,1]<stderr>:                                   [--speculative-accept-threshold-single SPECULATIVE_ACCEPT_THRESHOLD_SINGLE]
[1,1]<stderr>:                                   [--speculative-accept-threshold-acc SPECULATIVE_ACCEPT_THRESHOLD_ACC]
[1,1]<stderr>:                                   [--speculative-token-map SPECULATIVE_TOKEN_MAP]
[1,1]<stderr>:                                   [--expert-parallel-size EXPERT_PARALLEL_SIZE]
[1,1]<stderr>:                                   [--moe-a2a-backend {deepep}]
[1,1]<stderr>:                                   [--enable-flashinfer-cutlass-moe]
[1,1]<stderr>:                                   [--enable-flashinfer-trtllm-moe]
[1,1]<stderr>:   [1,1]<stderr>:                                [--enable-flashinfer-allreduce-fusion]
[1,1]<stderr>:                                   [--deepep-mode {normal,low_latency,auto}]
[1,1]<stderr>:                                   [--ep-num-redundant-experts EP_NUM_REDUNDANT_EXPERTS]
[1,1]<stderr>:                                   [--ep-dispatch-algorithm EP_DISPATCH_ALGORITHM]
[1,1]<stderr>:                                   [--init-expert-location INIT_EXPERT_LOCATION]
[1,1]<stderr>:                                   [--enable-eplb]
[1,1]<stderr>:                                   [--eplb-algorithm EPLB_ALGORITHM]
[1,1]<stderr>:                                   [--eplb-rebalance-num-iterations EPLB_REBALANCE_NUM_ITERATIONS]
[1,1]<stderr>:                                   [--eplb-rebalance-layers-per-chunk EPLB_REBALANCE_LAYERS_PER_CHUNK]
[1,1]<stderr>:                                   [--expert-distribution-recorder-mode EXPERT_DISTRIBUTION_RECORDER_MODE]
[1,1]<stderr>:                                   [--expert-distribution-recorder-buffer-size EXPERT_DISTRIBUTION_RECORDER_BUFFER_SIZE]
[1,1]<stderr>:                                   [--enable-expert-distribution-metrics]
[1,1]<stderr>:                                   [--deepep-config DEEPEP_CONFIG]
[1,1]<stderr>:                                   [--moe-dense-tp-size MOE_DENSE_TP_SIZE]
[1,1]<stderr>:                                   [--enable-hierarchical-cache]
[1,1]<stderr>:                                   [--hicache-ratio HICACHE_RATIO]
[1,1]<stderr>:                                   [--hicache-size HICACHE_SIZE]
[1,1]<stderr>:                                   [--hicache-write-policy {write_back,write_through,write_through_selective}]
[1,1]<stderr>:                                   [--hicache-io-backend {direct,kernel}]
[1,1]<stderr>:                                   [--hicache-mem-layout {layer_first,page_first}]
[1,1]<stderr>:                                   [--hicache-storage-backend {file,mooncake,hf3fs,nixl}]
[1,1]<stderr>:                                   [--hicache-storage-prefetch-policy {best_effort,wait_complete,timeout}]
[1,1]<stderr>:                                   [--enable-double-sparsity]
[1,1]<stderr>:                                   [--ds-channel-config-path DS_CHANNEL_CONFIG_PATH]
[1,1]<stderr>:                                   [--ds-heavy-channel-num DS_HEAVY_CHANNEL_NUM]
[1,1]<stderr>:                                   [--ds-heavy-token-num DS_HEAVY_TOKEN_NUM]
[1,1]<stderr>:                                   [--ds-heavy-channel-type DS_HEAVY_CHANNEL_TYPE]
[1,1]<stderr>:                                   [--ds-sparse-decode-threshold DS_SPARSE_DECODE_THRESHOLD]
[1,1]<stderr>:                                   [--disable-radix-cache]
[1,1]<stderr>:                                   [--cuda-graph-max-bs CUDA_GRAPH_MAX_BS]
[1,1]<stderr>:                                   [--cuda-graph-bs CUDA_GRAPH_BS [CUDA_GRAPH_BS ...]]
[1,1]<stderr>:                                   [--disable-cuda-graph]
[1,1]<stderr>:                                   [--disable-cuda-graph-padding]
[1,1]<stderr>:                                   [--enable-profile-cuda-graph]
[1,1]<stderr>:                                   [--enable-cudagraph-gc]
[1,1]<stderr>:                                   [--enable-nccl-nvls] [--enable-symm-mem]
[1,1]<stderr>:                                   [--enable-tokenizer-batch-encode]
[1,1]<stderr>:                                   [--disable-outlines-disk-cache]
[1,1]<stderr>:                                   [--disable-custom-all-reduce]
[1,1]<stderr>:                                   [--enable-mscclpp]
[1,1]<stderr>:                                   [--disable-overlap-schedule]
[1,1]<stderr>:                                   [--enable-mixed-chunk]
[1,1]<stderr>:                                   [--enable-dp-attention]
[1,1]<stderr>:                                   [--enable-dp-lm-head]
[1,1]<stderr>:                                   [--enable-two-batch-overlap]
[1,1]<stderr>:                                   [--tbo-token-distribution-threshold TBO_TOKEN_DISTRIBUTION_THRESHOLD]
[1,1]<stderr>:                                   [--enable-torch-compile]
[1,1]<stderr>:                                   [--torch-compile-max-bs TORCH_COMPILE_MAX_BS]
[1,1]<stderr>:                                   [--torchao-config TORCHAO_CONFIG]
[1,1]<stderr>:                                   [--enable-nan-detection]
[1,1]<stderr>:                                   [--enable-p2p-check]
[1,1]<stderr>:                                   [--triton-attention-reduce-in-fp32]
[1,1]<stderr>:                                   [--triton-attention-num-kv-splits TRITON_ATTENTION_NUM_KV_SPLITS]
[1,1]<stderr>:                                   [--num-continuous-decode-steps NUM_CONTINUOUS_[1,1]<stderr>:DECODE_STEPS]
[1,1]<stderr>:                                   [--delete-ckpt-after-loading]
[1,1]<stderr>:                                   [--enable-memory-saver]
[1,1]<stderr>:                                   [--allow-auto-truncate]
[1,1]<stderr>:                                   [--enable-custom-logit-processor]
[1,1]<stderr>:                                   [--flashinfer-mla-disable-ragged]
[1,1]<stderr>:                                   [--disable-shared-experts-fusion]
[1,1]<stderr>:                                   [--disable-chunked-prefix-cache]
[1,1]<stderr>:                                   [--disable-fast-image-processor]
[1,1]<stderr>:                                   [--enable-return-hidden-states]
[1,1]<stderr>:                                   [--enable-triton-kernel-moe]
[1,1]<stderr>:                                   [--enable-flashinfer-mxfp4-moe]
[1,1]<stderr>:                                   [--scheduler-recv-interval SCHEDULER_RECV_INTERVAL]
[1,1]<stderr>:                                   [--debug-tensor-dump-output-folder DEBUG_TENSOR_DUMP_OUTPUT_FOLDER]
[1,1]<stderr>:                                   [--debug-tensor-dump-input-file DEBUG_TENSOR_DUMP_INPUT_FILE]
[1,1]<stderr>:                                   [--debug-tensor-dump-inject DEBUG_TENSOR_DUMP_INJECT]
[1,1]<stderr>:                                   [--debug-tensor-dump-prefill-only]
[1,1]<stderr>:                                   [--disaggregation-mode {null,prefill,decode}]
[1,1]<stderr>:                                   [--disaggregation-transfer-backend {mooncake,nixl,ascend}]
[1,1]<stderr>:                                   [--disaggregation-bootstrap-port DISAGGREGATION_BOOTSTRAP_PORT]
[1,1]<stderr>:                                   [--disaggregation-decode-tp DISAGGREGATION_DECODE_TP]
[1,1]<stderr>:                                   [--disaggregation-decode-dp DISAGGREGATION_DECODE_DP]
[1,1]<stderr>:                                   [--disaggregation-prefill-pp DISAGGREGATION_PREFILL_PP]
[1,1]<stderr>:                                   [--disaggregation-ib-device DISAGGREGATION_IB_DEVICE]
[1,1]<stderr>:                                   [--num-reserved-decode-tokens NUM_RESERVED_DECODE_TOKENS]
[1,1]<stderr>:                                   [--pdlb-url PDLB_URL]
[1,1]<stderr>:                                   [--custom-weight-loader [CUSTOM_WEIGHT_LOADER ...]]
[1,1]<stderr>:                                   [--enable-pdmux]
[1,1]<stderr>:                                   [--sm-group-num SM_GROUP_NUM]
[1,1]<stderr>:                                   [--weight-loader-disable-mmap]
[1,1]<stderr>:                                   [--enable-ep-moe] [--enable-deepep-moe]
[1,1]<stderr>:                                   [--backend BACKEND]
[1,1]<stderr>:                                   [--result-filename RESULT_FILENAME]
[1,1]<stderr>:                                   [--dataset-name {sharegpt,random,generated-shared-prefix}]
[1,1]<stderr>:                                   [--dataset-path DATASET_PATH]
[1,1]<stderr>:                                   [--num-prompts NUM_PROMPTS]
[1,1]<stderr>:                                   [--sharegpt-output-len SHAREGPT_OUTPUT_LEN]
[1,1]<stderr>:                                   [--sharegpt-context-len SHAREGPT_CONTEXT_LEN]
[1,1]<stderr>:                                   [--random-input-len RANDOM_INPUT_LEN]
[1,1]<stderr>:                                   [--random-output-len RANDOM_OUTPUT_LEN]
[1,1]<stderr>:                                   [--random-range-ratio RANDOM_RANGE_RATIO]
[1,1]<stderr>:                                   [--gsp-num-groups GSP_NUM_GROUPS]
[1,1]<stderr>:                                   [--gsp-prompts-per-group GSP_PROMPTS_PER_GROUP]
[1,1]<stderr>:                                   [--gsp-system-prompt-len GSP_SYSTEM_PROMPT_LEN]
[1,1]<stderr>:                                   [--gsp-question-len GSP_QUESTION_LEN]
[1,1]<stderr>:                                   [--gsp-output-len GSP_OUTPUT_LEN]
[1,1]<stderr>:                                   [--seed SEED] [--disable-ignore-eos]
[1,1]<stderr>:                                   [--extra-request-body {"key1": "value1", "key2": "value2"}]
[1,1]<stderr>:                                   [--apply-chat-template] [--profile]
[1,1]<stderr>:                                   [--skip-warmup] [--do-not-exit]
[1,1]<stderr>:                                   [--prompt-suffix PROMPT_SUFFIX]
[1,1]<stderr>:bench_offline_throughput.py: error: unrecognized arguments: --enable-paged-attn --overlap-comm --max-concurrency 32 --max-batch-size 32
--------------------------------------------------------------------------
Primary job  terminated normally, but 1 process returned
a non-zero exit code. Per user-direction, the job has been aborted.
--------------------------------------------------------------------------
--------------------------------------------------------------------------
mpirun detected that one or more processes exited with non-zero status, thus causing
the job to be terminated. The first process to do so was:

  Process name: [[38889,1],0]
  Exit code:    2
--------------------------------------------------------------------------

real	0m54.271s
user	0m10.430s
sys	0m6.688s
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
			Resource Usage on 2025-10-21 06:42:15.358130:
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	JobId: 99712.pbs111
	Project: 50000128
	Exit Status: 0
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	NCPUs: Requested(224), Used(224)
	CPU Time Used: 00:00:17
	Memory: Requested(3760gb), Used(1992720kb)
	Vmem Used: 611614300kb
	Walltime: Requested(06:00:00), Used(00:01:00)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Execution Nodes Used: (a2ap-dgx008:ncpus=112:ngpus=8:mem=1971322880kb)+(a2ap-dgx024:ncpus=112:ngpus=8:mem=1971322880kb)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	GPU Duration: 1.11mins
	GPU Power Consumed: 131.88W
	GPU Max GPU Memory Used: 0.0B
	Memory Throughput Rate (Average): a2ap-dgx008:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)+a2ap-dgx024:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)
	Memory Throughput Rate (Max): a2ap-dgx008:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)+a2ap-dgx024:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)
	Memory Throughput Rate (Min): a2ap-dgx008:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)+a2ap-dgx024:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)
	GPU SM Utilization (Average): a2ap-dgx008:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)+a2ap-dgx024:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)
	GPU SM Utilization (Max): a2ap-dgx008:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)+a2ap-dgx024:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)
	GPU SM Utilization (Min): a2ap-dgx008:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)+a2ap-dgx024:(gpu1:0%+gpu0:0%+gpu2:0%+gpu3:0%+gpu5:0%+gpu4:0%+gpu6:0%+gpu7:0%)
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Warning: All GPUs have a percentage of 0 utilisation.
GPU application profile: Idle
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

