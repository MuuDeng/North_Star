[1,2]<stderr>:[a2ap-dgx014:3002584] MCW rank 2 bound to socket 0[core 28[hwt 0-1]], socket 0[core 29[hwt 0-1]], socket 0[core 30[hwt 0-1]], socket 0[core 31[hwt 0-1]], socket 0[core 32[hwt 0-1]], socket 0[core 33[hwt 0-1]], socket 0[core 34[hwt 0-1]], socket 0[core 35[hwt 0-1]], socket 0[core 36[hwt 0-1]], socket 0[core 37[hwt 0-1]], socket 0[core 38[hwt 0-1]], socket 0[core 39[hwt 0-1]], socket 0[core 40[hwt 0-1]], socket 0[core 41[hwt 0-1]]: [../../../../../../../../../../../../../../../../../../../../../../../../../../../../BB/BB/BB/BB/BB/BB/BB/BB/BB/BB/BB/BB/BB/BB/../../../../../../../../../../../../../..][../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../../..]
[1,2]<stderr>:[INFO] Host=a2ap-dgx014 IF=bond0 Rank=2 LocalRank=2 NodeRank=0 WorldSize=16 Master=a2ap-dgx014.asp2p.nscc.sg:27831
[1,2]<stderr>:[DP] DP_SIZE=2 TP_SIZE=8 DP_RANK=0 NODE_RANK=0
[1,2]<stderr>:[RUN] Running rank 2 (node 0, local 2)
[1,2]<stderr>:usage: bench_offline_throughput.py [-h] --model-path MODEL_PATH
[1,2]<stderr>:                                   [--tokenizer-path TOKENIZER_PATH]
[1,2]<stderr>:                                   [--tokenizer-mode {auto,slow}]
[1,2]<stderr>:                                   [--skip-tokenizer-init]
[1,2]<stderr>:                                   [--load-format {auto,pt,safetensors,npcache,dummy,sharded_state,gguf,bitsandbytes,layered,remote}]
[1,2]<stderr>:                                   [--model-loader-extra-config MODEL_LOADER_EXTRA_CONFIG]
[1,2]<stderr>:                                   [--trust-remote-code]
[1,2]<stderr>:                                   [--context-length CONTEXT_LENGTH]
[1,2]<stderr>:                                   [--is-embedding] [--enable-multimodal]
[1,2]<stderr>:                                   [--revision REVISION]
[1,2]<stderr>:                                   [--model-impl MODEL_IMPL] [--host HOST]
[1,2]<stderr>:                                   [--port PORT] [--skip-server-warmup]
[1,2]<stderr>:                                   [--warmups WARMUPS] [--nccl-port NCCL_PORT]
[1,2]<stderr>:                                   [--dtype {auto,half,float16,bfloat16,float,float32}]
[1,2]<stderr>:                                   [--quantization {awq,fp8,gptq,marlin,gptq_marlin,awq_marlin,bitsandbytes,gguf,modelopt,modelopt_fp4,petit_nvfp4,w8a8_int8,w8a8_fp8,moe_wna16,qoq,w4afp8,mxfp4}]
[1,2]<stderr>:                                   [--quantization-param-path QUANTIZATION_PARAM_PATH]
[1,2]<stderr>:                                   [--kv-cache-dtype {auto,fp8_e5m2,fp8_e4m3}]
[1,2]<stderr>:                                   [--mem-fraction-static MEM_FRACTION_STATIC]
[1,2]<stderr>:                                   [--max-running-requests MAX_RUNNING_REQUESTS]
[1,2]<stderr>:                                   [--max-queued-requests MAX_QUEUED_REQUESTS]
[1,2]<stderr>:                                   [--max-total-tokens MAX_TOTAL_TOKENS]
[1,2]<stderr>:                                   [--chunked-prefill-size CHUNKED_PREFILL_SIZE]
[1,2]<stderr>:                                   [--max-prefill-tokens MAX_PREFILL_TOKENS]
[1,2]<stderr>:                                   [--schedule-policy {lpm,random,fcfs,dfs-weight,lof}]
[1,2]<stderr>:                                   [--schedule-conservativeness SCHEDULE_CONSERVATIVENESS]
[1,2]<stderr>:                                   [--cpu-offload-gb CPU_OFFLOAD_GB]
[1,2]<stderr>:                                   [--page-size PAGE_SIZE]
[1,2]<stderr>:                                   [--hybrid-kvcache-ratio [HYBRID_KVCACHE_RATIO]]
[1,2]<stderr>:                                   [--swa-full-tokens-ratio SWA_FULL_TOKENS_RATIO]
[1,2]<stderr>:                                   [--disable-hybrid-swa-memory]
[1,2]<stderr>:                                   [--device DEVICE]
[1,2]<stderr>:                                   [--tensor-parallel-size TENSOR_PARALLEL_SIZE]
[1,2]<stderr>:                                   [--pipeline-parallel-size PIPELINE_PARALLEL_SIZE]
[1,2]<stderr>:                                   [--max-micro-batch-size MAX_MICRO_BATCH_SIZE]
[1,2]<stderr>:                                   [--stream-interval STREAM_INTERVAL]
[1,2]<stderr>:                                   [--stream-output]
[1,2]<stderr>:                                   [--random-seed RANDOM_SEED]
[1,2]<stderr>:                                   [--constrained-json-whitespace-pattern CONSTRAINED_JSON_WHITESPACE_PATTERN]
[1,2]<stderr>:                                   [--watchdog-timeout WATCHDOG_TIMEOUT]
[1,2]<stderr>:                                   [--dist-timeout DIST_TIMEOUT]
[1,2]<stderr>:                                   [--download-dir DOWNLOAD_DIR]
[1,2]<stderr>:                                   [--base-gpu-id BASE_GPU_ID]
[1,2]<stderr>:                                   [--gpu-id-step GPU_ID_STEP]
[1,2]<stderr>:                                   [--sleep-on-idle] [--log-level LOG_LEVEL]
[1,2]<stderr>:                                   [--log-level-http LOG_LEVEL_HTTP]
[1,2]<stderr>:                                   [--log-requests]
[1,2]<stderr>:                                   [--log-requests-level {0,1,2,3}]
[1,2]<stderr>:                                   [--crash-dump-folder CRASH_DUMP_FOLDER]
[1,2]<stderr>:                                   [--show-time-cost] [--enable-metrics]
[1,2]<stderr>:                                   [--enable-metrics-for-all-schedulers]
[1,2]<stderr>:                                   [--bucket-time-to-first-token BUCKET_TIME_TO_FIRST_TOKEN [BUCKET_TIME_TO_FIRST_TOKEN ...]]
[1,2]<stderr>:                                   [--bucket-inter-token-latency BUCKET_INTER_TOKEN_LATENCY [BUCKET_INTER_TOKEN_LATENCY ...]]
[1,2]<stderr>:       [1,2]<stderr>:                            [--bucket-e2e-request-latency BUCKET_E2E_REQUEST_LATENCY [BUCKET_E2E_REQUEST_LATENCY ...]]
[1,2]<stderr>:                                   [--collect-tokens-histogram]
[1,2]<stderr>:                                   [--decode-log-interval DECODE_LOG_INTERVAL]
[1,2]<stderr>:                                   [--enable-request-time-stats-logging]
[1,2]<stderr>:                                   [--kv-events-config KV_EVENTS_CONFIG]
[1,2]<stderr>:                                   [--api-key API_KEY]
[1,2]<stderr>:                                   [--served-model-name SERVED_MODEL_NAME]
[1,2]<stderr>:                                   [--weight-version WEIGHT_VERSION]
[1,2]<stderr>:                                   [--chat-template CHAT_TEMPLATE]
[1,2]<stderr>:                                   [--completion-template COMPLETION_TEMPLATE]
[1,2]<stderr>:                                   [--file-storage-path FILE_STORAGE_PATH]
[1,2]<stderr>:                                   [--enable-cache-report]
[1,2]<stderr>:                                   [--reasoning-parser {deepseek-r1,qwen3,qwen3-thinking,glm45,kimi,step3,gpt-oss}]
[1,2]<stderr>:                                   [--tool-call-parser {qwen25,mistral,llama3,deepseekv3,pythonic,kimi_k2,qwen3_coder,glm45,step3,gpt-oss}]
[1,2]<stderr>:                                   [--tool-server TOOL_SERVER]
[1,2]<stderr>:                                   [--data-parallel-size DATA_PARALLEL_SIZE]
[1,2]<stderr>:                                   [--load-balance-method {round_robin,shortest_queue,minimum_tokens}]
[1,2]<stderr>:                                   [--dist-init-addr DIST_INIT_ADDR]
[1,2]<stderr>:                                   [--nnodes NNODES] [--node-rank NODE_RANK]
[1,2]<stderr>:                                   [--json-model-override-args JSON_MODEL_OVERRIDE_ARGS]
[1,2]<stderr>:                                   [--preferred-sampling-params PREFERRED_SAMPLING_PARAMS]
[1,2]<stderr>:                                   [--enable-lora]
[1,2]<stderr>:                                   [--max-lora-rank MAX_LORA_RANK]
[1,2]<stderr>:                                   [--lora-target-modules [{q_proj,k_proj,v_proj,o_proj,gate_proj,up_proj,down_proj,all} ...]]
[1,2]<stderr>:                                   [--lora-paths [LORA_PATHS ...]]
[1,2]<stderr>:                                   [--max-loras-per-batch MAX_LORAS_PER_BATCH]
[1,2]<stderr>:                                   [--max-loaded-loras MAX_LOADED_LORAS]
[1,2]<stderr>:                                   [--lora-backend LORA_BACKEND]
[1,2]<stderr>:                                   [--attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,2]<stderr>:                                   [--prefill-attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,2]<stderr>:                                   [--decode-attention-backend {triton,torch_native,cutlass_mla,fa3,flashinfer,flashmla,trtllm_mla,trtllm_mha,dual_chunk_flash_attn,aiter,wave,intel_amx,ascend}]
[1,2]<stderr>:                                   [--sampling-backend {flashinfer,pytorch}]
[1,2]<stderr>:                                   [--grammar-backend {xgrammar,outlines,llguidance,none}]
[1,2]<stderr>:                                   [--mm-attention-backend {sdpa,fa3,triton_attn}]
[1,2]<stderr>:                                   [--speculative-algorithm {EAGLE,EAGLE3,NEXTN}]
[1,2]<stderr>:                                   [--speculative-draft-model-path SPECULATIVE_DRAFT_MODEL_PATH]
[1,2]<stderr>:                                   [--speculative-num-steps SPECULATIVE_NUM_STEPS]
[1,2]<stderr>:                                   [--speculative-eagle-topk SPECULATIVE_EAGLE_TOPK]
[1,2]<stderr>:                                   [--speculative-num-draft-tokens SPECULATIVE_NUM_DRAFT_TOKENS]
[1,2]<stderr>:                                   [--speculative-accept-threshold-single SPECULATIVE_ACCEPT_THRESHOLD_SINGLE]
[1,2]<stderr>:                                   [--speculative-accept-threshold-acc SPECULATIVE_ACCEPT_THRESHOLD_ACC]
[1,2]<stderr>:                                   [--speculative-token-map SPECULATIVE_TOKEN_MAP]
[1,2]<stderr>:                                   [--expert-parallel-size EXPERT_PARALLEL_SIZE]
[1,2]<stderr>:                                   [--moe-a2a-backend {deepep}]
[1,2]<stderr>:                                   [--enable-flashinfer-cutlass-moe]
[1,2]<stderr>:                                   [--enable-flashinfer-trtllm-moe]
[1,2]<stderr>:   [1,2]<stderr>:                                [--enable-flashinfer-allreduce-fusion]
[1,2]<stderr>:                                   [--deepep-mode {normal,low_latency,auto}]
[1,2]<stderr>:                                   [--ep-num-redundant-experts EP_NUM_REDUNDANT_EXPERTS]
[1,2]<stderr>:                                   [--ep-dispatch-algorithm EP_DISPATCH_ALGORITHM]
[1,2]<stderr>:                                   [--init-expert-location INIT_EXPERT_LOCATION]
[1,2]<stderr>:                                   [--enable-eplb]
[1,2]<stderr>:                                   [--eplb-algorithm EPLB_ALGORITHM]
[1,2]<stderr>:                                   [--eplb-rebalance-num-iterations EPLB_REBALANCE_NUM_ITERATIONS]
[1,2]<stderr>:                                   [--eplb-rebalance-layers-per-chunk EPLB_REBALANCE_LAYERS_PER_CHUNK]
[1,2]<stderr>:                                   [--expert-distribution-recorder-mode EXPERT_DISTRIBUTION_RECORDER_MODE]
[1,2]<stderr>:                                   [--expert-distribution-recorder-buffer-size EXPERT_DISTRIBUTION_RECORDER_BUFFER_SIZE]
[1,2]<stderr>:                                   [--enable-expert-distribution-metrics]
[1,2]<stderr>:                                   [--deepep-config DEEPEP_CONFIG]
[1,2]<stderr>:                                   [--moe-dense-tp-size MOE_DENSE_TP_SIZE]
[1,2]<stderr>:                                   [--enable-hierarchical-cache]
[1,2]<stderr>:                                   [--hicache-ratio HICACHE_RATIO]
[1,2]<stderr>:                                   [--hicache-size HICACHE_SIZE]
[1,2]<stderr>:                                   [--hicache-write-policy {write_back,write_through,write_through_selective}]
[1,2]<stderr>:                                   [--hicache-io-backend {direct,kernel}]
[1,2]<stderr>:                                   [--hicache-mem-layout {layer_first,page_first}]
[1,2]<stderr>:                                   [--hicache-storage-backend {file,mooncake,hf3fs,nixl}]
[1,2]<stderr>:                                   [--hicache-storage-prefetch-policy {best_effort,wait_complete,timeout}]
[1,2]<stderr>:                                   [--enable-double-sparsity]
[1,2]<stderr>:                                   [--ds-channel-config-path DS_CHANNEL_CONFIG_PATH]
[1,2]<stderr>:                                   [--ds-heavy-channel-num DS_HEAVY_CHANNEL_NUM]
[1,2]<stderr>:                                   [--ds-heavy-token-num DS_HEAVY_TOKEN_NUM]
[1,2]<stderr>:                                   [--ds-heavy-channel-type DS_HEAVY_CHANNEL_TYPE]
[1,2]<stderr>:                                   [--ds-sparse-decode-threshold DS_SPARSE_DECODE_THRESHOLD]
[1,2]<stderr>:                                   [--disable-radix-cache]
[1,2]<stderr>:                                   [--cuda-graph-max-bs CUDA_GRAPH_MAX_BS]
[1,2]<stderr>:                                   [--cuda-graph-bs CUDA_GRAPH_BS [CUDA_GRAPH_BS ...]]
[1,2]<stderr>:                                   [--disable-cuda-graph]
[1,2]<stderr>:                                   [--disable-cuda-graph-padding]
[1,2]<stderr>:                                   [--enable-profile-cuda-graph]
[1,2]<stderr>:                                   [--enable-cudagraph-gc]
[1,2]<stderr>:                                   [--enable-nccl-nvls] [--enable-symm-mem]
[1,2]<stderr>:                                   [--enable-tokenizer-batch-encode]
[1,2]<stderr>:                                   [--disable-outlines-disk-cache]
[1,2]<stderr>:                                   [--disable-custom-all-reduce]
[1,2]<stderr>:                                   [--enable-mscclpp]
[1,2]<stderr>:                                   [--disable-overlap-schedule]
[1,2]<stderr>:                                   [--enable-mixed-chunk]
[1,2]<stderr>:                                   [--enable-dp-attention]
[1,2]<stderr>:                                   [--enable-dp-lm-head]
[1,2]<stderr>:                                   [--enable-two-batch-overlap]
[1,2]<stderr>:                                   [--tbo-token-distribution-threshold TBO_TOKEN_DISTRIBUTION_THRESHOLD]
[1,2]<stderr>:                                   [--enable-torch-compile]
[1,2]<stderr>:                                   [--torch-compile-max-bs TORCH_COMPILE_MAX_BS]
[1,2]<stderr>:                                   [--torchao-config TORCHAO_CONFIG]
[1,2]<stderr>:                                   [--enable-nan-detection]
[1,2]<stderr>:                                   [--enable-p2p-check]
[1,2]<stderr>:                                   [--triton-attention-reduce-in-fp32]
[1,2]<stderr>:                                   [--triton-attention-num-kv-splits TRITON_ATTENTION_NUM_KV_SPLITS]
[1,2]<stderr>:                                   [--num-continuous-decode-steps NUM_CONTINUOUS_[1,2]<stderr>:DECODE_STEPS]
[1,2]<stderr>:                                   [--delete-ckpt-after-loading]
[1,2]<stderr>:                                   [--enable-memory-saver]
[1,2]<stderr>:                                   [--allow-auto-truncate]
[1,2]<stderr>:                                   [--enable-custom-logit-processor]
[1,2]<stderr>:                                   [--flashinfer-mla-disable-ragged]
[1,2]<stderr>:                                   [--disable-shared-experts-fusion]
[1,2]<stderr>:                                   [--disable-chunked-prefix-cache]
[1,2]<stderr>:                                   [--disable-fast-image-processor]
[1,2]<stderr>:                                   [--enable-return-hidden-states]
[1,2]<stderr>:                                   [--enable-triton-kernel-moe]
[1,2]<stderr>:                                   [--enable-flashinfer-mxfp4-moe]
[1,2]<stderr>:                                   [--scheduler-recv-interval SCHEDULER_RECV_INTERVAL]
[1,2]<stderr>:                                   [--debug-tensor-dump-output-folder DEBUG_TENSOR_DUMP_OUTPUT_FOLDER]
[1,2]<stderr>:                                   [--debug-tensor-dump-input-file DEBUG_TENSOR_DUMP_INPUT_FILE]
[1,2]<stderr>:                                   [--debug-tensor-dump-inject DEBUG_TENSOR_DUMP_INJECT]
[1,2]<stderr>:                                   [--debug-tensor-dump-prefill-only]
[1,2]<stderr>:                                   [--disaggregation-mode {null,prefill,decode}]
[1,2]<stderr>:                                   [--disaggregation-transfer-backend {mooncake,nixl,ascend}]
[1,2]<stderr>:                                   [--disaggregation-bootstrap-port DISAGGREGATION_BOOTSTRAP_PORT]
[1,2]<stderr>:                                   [--disaggregation-decode-tp DISAGGREGATION_DECODE_TP]
[1,2]<stderr>:                                   [--disaggregation-decode-dp DISAGGREGATION_DECODE_DP]
[1,2]<stderr>:                                   [--disaggregation-prefill-pp DISAGGREGATION_PREFILL_PP]
[1,2]<stderr>:                                   [--disaggregation-ib-device DISAGGREGATION_IB_DEVICE]
[1,2]<stderr>:                                   [--num-reserved-decode-tokens NUM_RESERVED_DECODE_TOKENS]
[1,2]<stderr>:                                   [--pdlb-url PDLB_URL]
[1,2]<stderr>:                                   [--custom-weight-loader [CUSTOM_WEIGHT_LOADER ...]]
[1,2]<stderr>:                                   [--enable-pdmux]
[1,2]<stderr>:                                   [--sm-group-num SM_GROUP_NUM]
[1,2]<stderr>:                                   [--weight-loader-disable-mmap]
[1,2]<stderr>:                                   [--enable-ep-moe] [--enable-deepep-moe]
[1,2]<stderr>:                                   [--backend BACKEND]
[1,2]<stderr>:                                   [--result-filename RESULT_FILENAME]
[1,2]<stderr>:                                   [--dataset-name {sharegpt,random,generated-shared-prefix}]
[1,2]<stderr>:                                   [--dataset-path DATASET_PATH]
[1,2]<stderr>:                                   [--num-prompts NUM_PROMPTS]
[1,2]<stderr>:                                   [--sharegpt-output-len SHAREGPT_OUTPUT_LEN]
[1,2]<stderr>:                                   [--sharegpt-context-len SHAREGPT_CONTEXT_LEN]
[1,2]<stderr>:                                   [--random-input-len RANDOM_INPUT_LEN]
[1,2]<stderr>:                                   [--random-output-len RANDOM_OUTPUT_LEN]
[1,2]<stderr>:                                   [--random-range-ratio RANDOM_RANGE_RATIO]
[1,2]<stderr>:                                   [--gsp-num-groups GSP_NUM_GROUPS]
[1,2]<stderr>:                                   [--gsp-prompts-per-group GSP_PROMPTS_PER_GROUP]
[1,2]<stderr>:                                   [--gsp-system-prompt-len GSP_SYSTEM_PROMPT_LEN]
[1,2]<stderr>:                                   [--gsp-question-len GSP_QUESTION_LEN]
[1,2]<stderr>:                                   [--gsp-output-len GSP_OUTPUT_LEN]
[1,2]<stderr>:                                   [--seed SEED] [--disable-ignore-eos]
[1,2]<stderr>:                                   [--extra-request-body {"key1": "value1", "key2": "value2"}]
[1,2]<stderr>:                                   [--apply-chat-template] [--profile]
[1,2]<stderr>:                                   [--skip-warmup] [--do-not-exit]
[1,2]<stderr>:                                   [--prompt-suffix PROMPT_SUFFIX]
[1,2]<stderr>:bench_offline_throughput.py: error: argument --tensor-parallel-size/--tp-size: invalid int value: ''
